{
  "information": {
    "description": [
      {
        "id": "CVE-2019-19781",
        "parameters": {
          "published": "2019-12-27T14:15Z",
          "modified": "2020-01-08T19:15Z",
          "summary": "An issue was discovered in Citrix Application Delivery Controller (ADC) and Gateway 10.5, 11.1, 12.0, 12.1, and 13.0. They allow Directory Traversal."
        }
      }
    ],
    "references": [
      {
        "vendor": "CONFIRM",
        "url": "https://support.citrix.com/article/CTX267027"
      },
      {
        "vendor": "CERT-VN",
        "url": "https://www.kb.cert.org/vuls/id/619785"
      }
    ]
  },
  "classification": {
    "targets": [
      {
        "id": 1,
        "parameters": [
          {
            "title": "Citrix Application Delivery Controller Firmware 10.5",
            "cpe2.2": "cpe:/o:citrix:application_delivery_controller_firmware:10.5",
            "cpe2.3": "cpe:2.3:o:citrix:application_delivery_controller_firmware:10.5:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Citrix Application Delivery Controller Firmware 11.1",
            "cpe2.2": "cpe:/o:citrix:application_delivery_controller_firmware:11.1",
            "cpe2.3": "cpe:2.3:o:citrix:application_delivery_controller_firmware:11.1:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Citrix Application Delivery Controller Firmware 12.0",
            "cpe2.2": "cpe:/o:citrix:application_delivery_controller_firmware:12.0",
            "cpe2.3": "cpe:2.3:o:citrix:application_delivery_controller_firmware:12.0:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Citrix Application Delivery Controller (ADC) Firmware 12.1",
            "cpe2.2": "cpe:/o:citrix:application_delivery_controller_firmware:12.1",
            "cpe2.3": "cpe:2.3:o:citrix:application_delivery_controller_firmware:12.1:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Citrix Application Delivery Controller (ADC) Firmware 13.0",
            "cpe2.2": "cpe:/o:citrix:application_delivery_controller_firmware:13.0",
            "cpe2.3": "cpe:2.3:o:citrix:application_delivery_controller_firmware:13.0:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "running_on": [
              {
                "title": null,
                "cpe2.2": "cpe:/h:citrix:application_delivery_controller:-",
                "cpe2.3": "cpe:2.3:h:citrix:application_delivery_controller:-:*:*:*:*:*:*:*"
              }
            ]
          }
        ]
      },
      {
        "id": 2,
        "parameters": [
          {
            "title": "Citrix NetScaler Gateway Firmware 10.5",
            "cpe2.2": "cpe:/o:citrix:netscaler_gateway_firmware:10.5",
            "cpe2.3": "cpe:2.3:o:citrix:netscaler_gateway_firmware:10.5:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Citrix NetScaler Gateway Firmware 11.1",
            "cpe2.2": "cpe:/o:citrix:netscaler_gateway_firmware:11.1",
            "cpe2.3": "cpe:2.3:o:citrix:netscaler_gateway_firmware:11.1:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Citrix NetScaler Gateway Firmware 12.0",
            "cpe2.2": "cpe:/o:citrix:netscaler_gateway_firmware:12.0",
            "cpe2.3": "cpe:2.3:o:citrix:netscaler_gateway_firmware:12.0:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Citrix NetScaler Gateway Firmware 12.1",
            "cpe2.2": "cpe:/o:citrix:netscaler_gateway_firmware:12.1",
            "cpe2.3": "cpe:2.3:o:citrix:netscaler_gateway_firmware:12.1:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "running_on": [
              {
                "title": null,
                "cpe2.2": "cpe:/h:citrix:netscaler_gateway:-",
                "cpe2.3": "cpe:2.3:h:citrix:netscaler_gateway:-:*:*:*:*:*:*:*"
              }
            ]
          }
        ]
      },
      {
        "id": 3,
        "parameters": [
          {
            "title": "Citrix Gateway Firmware 13.0",
            "cpe2.2": "cpe:/o:citrix:gateway_firmware:13.0",
            "cpe2.3": "cpe:2.3:o:citrix:gateway_firmware:13.0:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "running_on": [
              {
                "title": "Citrix Gateway",
                "cpe2.2": "cpe:/h:citrix:gateway:-",
                "cpe2.3": "cpe:2.3:h:citrix:gateway:-:*:*:*:*:*:*:*"
              }
            ]
          }
        ]
      }
    ],
    "packages": [],
    "weaknesses": [
      {
        "id": "CWE-22",
        "parameters": {
          "class": "weakness",
          "title": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
          "relationship": "CWE-668,CWE-706",
          "url": "https://cwe.mitre.org/data/definitions/22.html",
          "attack_patterns": [
            {
              "id": "CAPEC-79",
              "parameters": {
                "title": "Using Slashes in Alternate Encoding",
                "attack_methods": "",
                "mitigations": "Assume all input is malicious. Create an allowlist that defines all valid input to the application based on the requirements specifications. Input that does not match against the allowlist should not be permitted to enter into the system.|In the case of path traversals, use the principle of least privilege when determining access rights to file systems. Do not allow users to access directories/files that they should not access.|Test your path decoding process against malicious input.|Be aware of the threat of alternative method of data encoding and obfuscation technique such as IP address encoding. (See related guideline section)|There are tools to scan HTTP requests to the server for valid URL such as URLScan from Microsoft (http://www.microsoft.com/technet/security/tools/urlscan.mspx)|When client input is required from web-based forms, avoid using the \"GET\" method to submit data, as the method causes the form data to be appended to the URL and is easily manipulated. Instead, use the \"POST method whenever possible.|Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process. Refer to the RFCs to safely decode URL.",
                "url": "https://capec.mitre.org/data/definitions/79.html"
              }
            },
            {
              "id": "CAPEC-78",
              "parameters": {
                "title": "Using Escaped Slashes in Alternate Encoding",
                "attack_methods": "",
                "mitigations": "Avoid making decisions based on names of resources (e.g. files) if those resources can have alternate names.|Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process.|In the case of path traversals, use the principle of least privilege when determining access rights to file systems. Do not allow users to access directories/files that they should not access.|Regular expressions can be used to filter out backslash. Make sure you decode before filtering and validating the untrusted input data.|Be aware of the threat of alternative method of data encoding.|Assume all input is malicious. Create an allowlist that defines all valid input to the software system based on the requirements specifications. Input that does not match against the allowlist should not be permitted to enter into the system.|Verify that the user-supplied data does not use backslash character to escape malicious characters.",
                "url": "https://capec.mitre.org/data/definitions/78.html"
              }
            },
            {
              "id": "CAPEC-76",
              "parameters": {
                "title": "Manipulating Web Input to File System Calls",
                "attack_methods": "",
                "mitigations": "Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.|Design: For interactive user applications, consider if direct file system interface is necessary, instead consider having the application proxy communication.|Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.|Design: Ensure all input is validated, and does not contain file system commands|Design: Enforce principle of least privilege.",
                "url": "https://capec.mitre.org/data/definitions/76.html"
              }
            },
            {
              "id": "CAPEC-64",
              "parameters": {
                "title": "Using Slashes and URL Encoding Combined to Bypass Validation Logic",
                "attack_methods": "",
                "mitigations": "There are tools to scan HTTP requests to the server for valid URL such as URLScan from Microsoft (http://www.microsoft.com/technet/security/tools/urlscan.mspx).|Regular expression can be used to match safe URL patterns. However, that may discard valid URL requests if the regular expression is too restrictive.|Refer to the RFCs to safely decode URL.|Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process.|When client input is required from web-based forms, avoid using the \"GET\" method to submit data, as the method causes the form data to be appended to the URL and is easily manipulated. Instead, use the \"POST method whenever possible.|Be aware of the threat of alternative method of data encoding and obfuscation technique such as IP address encoding.|Assume all input is malicious. Create an allowlist that defines all valid input to the software system based on the requirements specifications. Input that does not match against the allowlist should not be permitted to enter into the system. Test your decoding process against malicious input.",
                "url": "https://capec.mitre.org/data/definitions/64.html"
              }
            },
            {
              "id": "CAPEC-126",
              "parameters": {
                "title": "Path Traversal",
                "attack_methods": "",
                "mitigations": "Implementation: Validate user input by only accepting known good. Ensure all content that is delivered to client is sanitized against an acceptable content specification -- using an allowlist approach.|Implementation: Use possible permissions on file access when developing and deploying web applications.|Implementation: Use indirect references rather than actual file names.|Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.|Implementation: Perform input validation for all remote content, including remote and user-generated content.|Implementation: Host integrity monitoring for critical files, directories, and processes. The goal of host integrity monitoring is to be aware when a security issue has occurred so that incident response and other forensic activities can begin.|Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.|Design: Proxy communication to host, so that communications are terminated at the proxy, sanitizing the requests before forwarding to server host.|Design: Input validation. Assume that user inputs are malicious. Utilize strict type, character, and encoding enforcement.|Design: Execute programs with constrained privileges, so parent process does not open up further vulnerabilities. Ensure that all directories, temporary directories and files, and memory are executing with limited privileges to protect against remote execution.|Design: Enforce principle of least privilege.|Design: Configure the access control correctly.",
                "url": "https://capec.mitre.org/data/definitions/126.html"
              }
            }
          ],
          "ranking": {
            "categorization": [
              {
                "id": "CWE-1031",
                "parameters": {
                  "title": "OWASP Top Ten 2017 Category A5 - Broken Access Control",
                  "url": "https://cwe.mitre.org/data/definitions/1031.html"
                }
              },
              {
                "id": "CWE-1131",
                "parameters": {
                  "title": "CISQ Quality Measures - Security",
                  "url": "https://cwe.mitre.org/data/definitions/1131.html"
                }
              },
              {
                "id": "CWE-1200",
                "parameters": {
                  "title": "Weaknesses in the 2019 CWE Top 25 Most Dangerous Software Errors",
                  "url": "https://cwe.mitre.org/data/definitions/1200.html"
                }
              },
              {
                "id": "CWE-1308",
                "parameters": {
                  "title": "CISQ Quality Measures - Security",
                  "url": "https://cwe.mitre.org/data/definitions/1308.html"
                }
              },
              {
                "id": "CWE-1350",
                "parameters": {
                  "title": "Weaknesses in the 2020 CWE Top 25 Most Dangerous Software Weaknesses",
                  "url": "https://cwe.mitre.org/data/definitions/1350.html"
                }
              },
              {
                "id": "CWE-635",
                "parameters": {
                  "title": "Weaknesses Originally Used by NVD from 2008 to 2016",
                  "url": "https://cwe.mitre.org/data/definitions/635.html"
                }
              },
              {
                "id": "CWE-715",
                "parameters": {
                  "title": "OWASP Top Ten 2007 Category A4 - Insecure Direct Object Reference",
                  "url": "https://cwe.mitre.org/data/definitions/715.html"
                }
              },
              {
                "id": "CWE-723",
                "parameters": {
                  "title": "OWASP Top Ten 2004 Category A2 - Broken Access Control",
                  "url": "https://cwe.mitre.org/data/definitions/723.html"
                }
              },
              {
                "id": "CWE-743",
                "parameters": {
                  "title": "CERT C Secure Coding Standard (2008) Chapter 10 - Input Output (FIO)",
                  "url": "https://cwe.mitre.org/data/definitions/743.html"
                }
              },
              {
                "id": "CWE-802",
                "parameters": {
                  "title": "2010 Top 25 - Risky Resource Management",
                  "url": "https://cwe.mitre.org/data/definitions/802.html"
                }
              },
              {
                "id": "CWE-813",
                "parameters": {
                  "title": "OWASP Top Ten 2010 Category A4 - Insecure Direct Object References",
                  "url": "https://cwe.mitre.org/data/definitions/813.html"
                }
              },
              {
                "id": "CWE-865",
                "parameters": {
                  "title": "2011 Top 25 - Risky Resource Management",
                  "url": "https://cwe.mitre.org/data/definitions/865.html"
                }
              },
              {
                "id": "CWE-877",
                "parameters": {
                  "title": "CERT C++ Secure Coding Section 09 - Input Output (FIO)",
                  "url": "https://cwe.mitre.org/data/definitions/877.html"
                }
              },
              {
                "id": "CWE-884",
                "parameters": {
                  "title": "CWE Cross-section",
                  "url": "https://cwe.mitre.org/data/definitions/884.html"
                }
              },
              {
                "id": "CWE-932",
                "parameters": {
                  "title": "OWASP Top Ten 2013 Category A4 - Insecure Direct Object References",
                  "url": "https://cwe.mitre.org/data/definitions/932.html"
                }
              },
              {
                "id": "CWE-981",
                "parameters": {
                  "title": "SFP Secondary Cluster: Path Traversal",
                  "url": "https://cwe.mitre.org/data/definitions/981.html"
                }
              }
            ],
            "wasc": [
              {
                "id": "WASC-33",
                "parameters": {
                  "title": "Path Traversal",
                  "url": "http://projects.webappsec.org/Path-Traversal"
                }
              }
            ],
            "att&ck_mitre": []
          }
        }
      }
    ]
  },
  "risk": {
    "cvss": {
      "cvss2": {
        "vector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
        "base_score": "7.5",
        "impact_score": "6.4",
        "exploit_score": "10.0",
        "access_vector": "NETWORK",
        "access_complexity": "LOW",
        "authentication": "NONE",
        "confidentiality_impact": "PARTIAL",
        "integrity_impact": "PARTIAL",
        "availability_impact": "PARTIAL"
      },
      "cvss3": {
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
        "base_score": "9.8",
        "impact_score": "5.9",
        "exploit_score": "3.9",
        "attack_vector": "NETWORK",
        "attack_complexity": "LOW",
        "privileges_required": "NONE",
        "user_interaction": "NONE",
        "score": "UNCHANGED",
        "confidentiality_impact": "HIGH",
        "integrity_impact": "HIGH",
        "availability_impact": "HIGH"
      }
    }
  },
  "inspection": {
    "remote": [
      {
        "nessus": [
          {
            "id": "132879",
            "parameters": {
              "family": "FreeBSD Local Security Checks",
              "name": "FreeBSD : Template::Toolkit -- Directory traversal on write (2bab995f-36d4-11ea-9dad-002590acae31)",
              "file": "freebsd_pkg_2bab995f36d411ea9dad002590acae31.nasl",
              "url": "https://www.tenable.com/plugins/index.php?view=single&id=132879"
            }
          },
          {
            "id": "132397",
            "parameters": {
              "family": "CGI abuses",
              "name": "Citrix ADC and Citrix NetScaler Gateway Arbitrary Code Execution (CTX267027)",
              "file": "citrix_netscaler_CTX267027.nasl",
              "url": "https://www.tenable.com/plugins/index.php?view=single&id=132397"
            }
          }
        ]
      }
    ],
    "local": []
  },
  "exploitation": [
    {
      "exploitdb": [
        {
          "id": "47901",
          "parameters": {
            "title": "Citrix Application Delivery Controller and Citrix Gateway - Remote Code Execution (PoC)",
            "file": "exploit-database/exploits/multiple/webapps/47901.sh",
            "url": "https://www.exploit-db.com/exploits/47901/"
          }
        },
        {
          "id": "47902",
          "parameters": {
            "title": "Citrix Application Delivery Controller and Citrix Gateway - Remote Code Execution",
            "file": "exploit-database/exploits/multiple/webapps/47902.py",
            "url": "https://www.exploit-db.com/exploits/47902/"
          }
        },
        {
          "id": "47913",
          "parameters": {
            "title": "Citrix Application Delivery Controller and Gateway 10.5 - Remote Code Execution (Metasploit)",
            "file": "exploit-database/exploits/multiple/webapps/47913.rb",
            "url": "https://www.exploit-db.com/exploits/47913/"
          }
        },
        {
          "id": "47930",
          "parameters": {
            "title": "Citrix Application Delivery Controller (ADC) and Gateway 13.0 - Path Traversal",
            "file": "exploit-database/exploits/multiple/webapps/47930.txt",
            "url": "https://www.exploit-db.com/exploits/47930/"
          }
        }
      ]
    },
    {
      "github": [
        {
          "id": "232945335",
          "parameters": {
            "title": "mekoko/CVE-2019-19781",
            "file": "https://github.com/mekoko/CVE-2019-19781",
            "url": "https://github.com/mekoko/CVE-2019-19781"
          }
        },
        {
          "id": "233143985",
          "parameters": {
            "title": "Remote Code Execution Exploit for Citrix Application Delivery Controller and Citrix Gateway [ CVE-2019-19781 ]",
            "file": "https://github.com/projectzeroindia/CVE-2019-19781",
            "url": "https://github.com/projectzeroindia/CVE-2019-19781"
          }
        },
        {
          "id": "233151210",
          "parameters": {
            "title": "This is a tool published for the Citrix ADC (NetScaler) vulnerability. We are only disclosing this due to others publishing the exploit code first.",
            "file": "https://github.com/trustedsec/cve-2019-19781",
            "url": "https://github.com/trustedsec/cve-2019-19781"
          }
        },
        {
          "id": "233152918",
          "parameters": {
            "title": "Test a host for susceptibility to CVE-2019-19781",
            "file": "https://github.com/cisagov/check-cve-2019-19781",
            "url": "https://github.com/cisagov/check-cve-2019-19781"
          }
        },
        {
          "id": "233168483",
          "parameters": {
            "title": "Citrix ADC Remote Code Execution",
            "file": "https://github.com/jas502n/CVE-2019-19781",
            "url": "https://github.com/jas502n/CVE-2019-19781"
          }
        },
        {
          "id": "233192322",
          "parameters": {
            "title": "Remote Code Execution Exploit for Citrix Application Delivery Controller and Citrix Gateway [ CVE-2019-19781 ]",
            "file": "https://github.com/ianxtianxt/CVE-2019-19781",
            "url": "https://github.com/ianxtianxt/CVE-2019-19781"
          }
        },
        {
          "id": "233209505",
          "parameters": {
            "title": "CVE-2019-19781 - Remote Code Execution on Citrix ADC Netscaler exploit",
            "file": "https://github.com/mpgn/CVE-2019-19781",
            "url": "https://github.com/mpgn/CVE-2019-19781"
          }
        },
        {
          "id": "233232989",
          "parameters": {
            "title": "CVE-2019-19781 Citrix RCE",
            "file": "https://github.com/oways/CVE-2019-19781",
            "url": "https://github.com/oways/CVE-2019-19781"
          }
        },
        {
          "id": "233274912",
          "parameters": {
            "title": "Took at stab at an NSE discovery script for CVE-2019-19781.",
            "file": "https://github.com/becrevex/Citrix_CVE-2019-19781",
            "url": "https://github.com/becrevex/Citrix_CVE-2019-19781"
          }
        },
        {
          "id": "233294562",
          "parameters": {
            "title": "All Working Exploits",
            "file": "https://github.com/unknowndevice64/Exploits_CVE-2019-19781",
            "url": "https://github.com/unknowndevice64/Exploits_CVE-2019-19781"
          }
        },
        {
          "id": "233359795",
          "parameters": {
            "title": "CVE-2019-19781",
            "file": "https://github.com/bufsnake/CVE-2019-19781",
            "url": "https://github.com/bufsnake/CVE-2019-19781"
          }
        },
        {
          "id": "233412280",
          "parameters": {
            "title": "A fast multi threaded scanner for Citrix ADC (NetScaler) CVE-2019-19781 - Citrixmash / Shitrix",
            "file": "https://github.com/x1sec/citrixmash_scanner",
            "url": "https://github.com/x1sec/citrixmash_scanner"
          }
        },
        {
          "id": "233441884",
          "parameters": {
            "title": "My working exploit script for Shitrix (CVE-2019-19781)",
            "file": "https://github.com/Jabo-SCO/Shitrix-CVE-2019-19781",
            "url": "https://github.com/Jabo-SCO/Shitrix-CVE-2019-19781"
          }
        },
        {
          "id": "233473212",
          "parameters": {
            "title": "DFIR notes for Citrix ADC (NetScaler) appliances vulnerable to CVE-2019-19781",
            "file": "https://github.com/x1sec/CVE-2019-19781",
            "url": "https://github.com/x1sec/CVE-2019-19781"
          }
        },
        {
          "id": "233493025",
          "parameters": {
            "title": "Citrix Netscaler RCE",
            "file": "https://github.com/hollerith/CVE-2019-19781",
            "url": "https://github.com/hollerith/CVE-2019-19781"
          }
        },
        {
          "id": "233538988",
          "parameters": {
            "title": "Automated script for Citrix ADC scanner (CVE-2019-19781) using hosts retrieved from Shodan API. You must have a Shodan account to use this script.",
            "file": "https://github.com/aqhmal/CVE-2019-19781",
            "url": "https://github.com/aqhmal/CVE-2019-19781"
          }
        },
        {
          "id": "233566324",
          "parameters": {
            "title": "Detect and log CVE-2019-19781 scan and exploitation attempts.",
            "file": "https://github.com/MalwareTech/CitrixHoneypot",
            "url": "https://github.com/MalwareTech/CitrixHoneypot"
          }
        },
        {
          "id": "233609919",
          "parameters": {
            "title": "The exploitation module for the CVE-2019-19781 #Shitrix (Vulnerability in Citrix Application Delivery Controller and Citrix Gateway).",
            "file": "https://github.com/mekhalleh/citrix_dir_traversal_rce",
            "url": "https://github.com/mekhalleh/citrix_dir_traversal_rce"
          }
        },
        {
          "id": "233943421",
          "parameters": {
            "title": "zenturacp/cve-2019-19781-web",
            "file": "https://github.com/zenturacp/cve-2019-19781-web",
            "url": "https://github.com/zenturacp/cve-2019-19781-web"
          }
        },
        {
          "id": "234053519",
          "parameters": {
            "title": "Check your website for CVE-2019-19781 Vulnerable",
            "file": "https://github.com/zgelici/CVE-2019-19781-Checker",
            "url": "https://github.com/zgelici/CVE-2019-19781-Checker"
          }
        },
        {
          "id": "234157094",
          "parameters": {
            "title": "IOCs for CVE-2019-19781",
            "file": "https://github.com/digitalshadows/CVE-2019-19781_IOCs",
            "url": "https://github.com/digitalshadows/CVE-2019-19781_IOCs"
          }
        },
        {
          "id": "234169492",
          "parameters": {
            "title": "Automated forensic script hunting for cve-2019-19781",
            "file": "https://github.com/onSec-fr/CVE-2019-19781-Forensic",
            "url": "https://github.com/onSec-fr/CVE-2019-19781-Forensic"
          }
        },
        {
          "id": "234275841",
          "parameters": {
            "title": "This script checks the Citrix Netscaler if it has been compromised by CVE-2019-19781 attacks and collects all file system information",
            "file": "https://github.com/DanielWep/CVE-NetScalerFileSystemCheck",
            "url": "https://github.com/DanielWep/CVE-NetScalerFileSystemCheck"
          }
        },
        {
          "id": "234291404",
          "parameters": {
            "title": "Castaldio86/Detect-CVE-2019-19781",
            "file": "https://github.com/Castaldio86/Detect-CVE-2019-19781",
            "url": "https://github.com/Castaldio86/Detect-CVE-2019-19781"
          }
        },
        {
          "id": "234315880",
          "parameters": {
            "title": "Check ADC for CVE-2019-19781",
            "file": "https://github.com/j81blog/ADC-19781",
            "url": "https://github.com/j81blog/ADC-19781"
          }
        },
        {
          "id": "234482699",
          "parameters": {
            "title": "",
            "file": "https://github.com/b510/CVE-2019-19781",
            "url": "https://github.com/b510/CVE-2019-19781"
          }
        },
        {
          "id": "234586442",
          "parameters": {
            "title": "CVE-2019-19781 Attack Triage Script",
            "file": "https://github.com/redscan/CVE-2019-19781",
            "url": "https://github.com/redscan/CVE-2019-19781"
          }
        },
        {
          "id": "235032279",
          "parameters": {
            "title": "DIVD-NL/Citrix-CVE-2019-19781",
            "file": "https://github.com/DIVD-NL/Citrix-CVE-2019-19781",
            "url": "https://github.com/DIVD-NL/Citrix-CVE-2019-19781"
          }
        },
        {
          "id": "235133886",
          "parameters": {
            "title": "CVE-2019-19781 bash exploit",
            "file": "https://github.com/ynsmroztas/citrix.sh",
            "url": "https://github.com/ynsmroztas/citrix.sh"
          }
        },
        {
          "id": "235372759",
          "parameters": {
            "title": "Cdigo desenvolvido para a verificao em massa da vulnerabilidade CVE-2019-19781 de hosts descobertos pelo Shodan. Pull requests so bem vindas.",
            "file": "https://github.com/digitalgangst/massCitrix",
            "url": "https://github.com/digitalgangst/massCitrix"
          }
        },
        {
          "id": "235373247",
          "parameters": {
            "title": "Indicator of Compromise Scanner for CVE-2019-19781",
            "file": "https://github.com/fireeye/ioc-scanner-CVE-2019-19781",
            "url": "https://github.com/fireeye/ioc-scanner-CVE-2019-19781"
          }
        },
        {
          "id": "235459837",
          "parameters": {
            "title": "Indicator of Compromise Scanner for CVE-2019-19781",
            "file": "https://github.com/citrix/ioc-scanner-CVE-2019-19781",
            "url": "https://github.com/citrix/ioc-scanner-CVE-2019-19781"
          }
        },
        {
          "id": "235574304",
          "parameters": {
            "title": "Citrix ADC (NetScaler) Honeypot. Supports detection for CVE-2019-19781 and login attempts",
            "file": "https://github.com/x1sec/citrix-honeypot",
            "url": "https://github.com/x1sec/citrix-honeypot"
          }
        },
        {
          "id": "235725853",
          "parameters": {
            "title": ":microscope: Jupyter notebook to help automate some of the forensic analysis related to Citrix Netscalers compromised via CVE-2019-19781",
            "file": "https://github.com/L4r1k/CitrixNetscalerAnalysis",
            "url": "https://github.com/L4r1k/CitrixNetscalerAnalysis"
          }
        },
        {
          "id": "235755055",
          "parameters": {
            "title": "My Citrix ADC NetScaler CVE-2019-19781 Vulnerability DFIR notes.",
            "file": "https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes",
            "url": "https://github.com/Azeemering/CVE-2019-19781-DFIR-Notes"
          }
        },
        {
          "id": "235820941",
          "parameters": {
            "title": "a script to look for CVE-2019-19781 Vulnerability within a domain and it's subdomains",
            "file": "https://github.com/0xams/citrixvulncheck",
            "url": "https://github.com/0xams/citrixvulncheck"
          }
        },
        {
          "id": "236726768",
          "parameters": {
            "title": "Python CVE-2019-19781 exploit",
            "file": "https://github.com/RaulCalvoLaorden/CVE-2019-19781",
            "url": "https://github.com/RaulCalvoLaorden/CVE-2019-19781"
          }
        },
        {
          "id": "245795935",
          "parameters": {
            "title": "Gather a list of Citrix appliances in a country / state pair, and check if they're vulnerable to CVE-2019-19781",
            "file": "https://github.com/nmanzi/webcvescanner",
            "url": "https://github.com/nmanzi/webcvescanner"
          }
        },
        {
          "id": "257219340",
          "parameters": {
            "title": "darren646/CVE-2019-19781POC",
            "file": "https://github.com/darren646/CVE-2019-19781POC",
            "url": "https://github.com/darren646/CVE-2019-19781POC"
          }
        },
        {
          "id": "262318473",
          "parameters": {
            "title": "citrix adc rce",
            "file": "https://github.com/5l1v3r1/Citrix_CVE-2019-19781",
            "url": "https://github.com/5l1v3r1/Citrix_CVE-2019-19781"
          }
        },
        {
          "id": "263051313",
          "parameters": {
            "title": "judge  vulnerability of the target",
            "file": "https://github.com/Jerry-Swift/CVE-2019-19781-scanner",
            "url": "https://github.com/Jerry-Swift/CVE-2019-19781-scanner"
          }
        },
        {
          "id": "263414399",
          "parameters": {
            "title": "This document explain Remote Code Execution Exploit for Citrix Application Delivery Controller and Citrix Gateway [CVE-2019-19781]",
            "file": "https://github.com/Roshi99/Remote-Code-Execution-Exploit-for-Citrix-Application-Delivery-Controller-and-Citrix-Gateway-CVE-201",
            "url": "https://github.com/Roshi99/Remote-Code-Execution-Exploit-for-Citrix-Application-Delivery-Controller-and-Citrix-Gateway-CVE-201"
          }
        },
        {
          "id": "266980943",
          "parameters": {
            "title": "yukar1z0e/CVE-2019-19781",
            "file": "https://github.com/yukar1z0e/CVE-2019-19781",
            "url": "https://github.com/yukar1z0e/CVE-2019-19781"
          }
        },
        {
          "id": "278269808",
          "parameters": {
            "title": "SharpHack/CVE-2019-19781",
            "file": "https://github.com/SharpHack/CVE-2019-19781",
            "url": "https://github.com/SharpHack/CVE-2019-19781"
          }
        },
        {
          "id": "278386517",
          "parameters": {
            "title": "pocpython3",
            "file": "https://github.com/qiong-qi/CVE-2019-19781-poc",
            "url": "https://github.com/qiong-qi/CVE-2019-19781-poc"
          }
        },
        {
          "id": "280411552",
          "parameters": {
            "title": "Citrix Unauthorized Remote Code Execution Attacker - CVE-2019-19781",
            "file": "https://github.com/w4fz5uck5/CVE-2019-19781-CitrixRCE",
            "url": "https://github.com/w4fz5uck5/CVE-2019-19781-CitrixRCE"
          }
        },
        {
          "id": "282933539",
          "parameters": {
            "title": "Citrix ADC scanner (CVE-2019-19781) using hosts retrieved from Shodan API.",
            "file": "https://github.com/andripwn/CVE-2019-19781",
            "url": "https://github.com/andripwn/CVE-2019-19781"
          }
        },
        {
          "id": "283838625",
          "parameters": {
            "title": "Shitrix : CVE-2019-19781 - Remote Code Execution on Citrix ADC Netscaler exploit",
            "file": "https://github.com/VladRico/CVE-2019-19781",
            "url": "https://github.com/VladRico/CVE-2019-19781"
          }
        }
      ]
    },
    {
      "metasploit": [
        {
          "id": "citrix_dir_traversal.rb",
          "parameters": {
            "title": "Citrix ADC (NetScaler) Directory Traversal Scanner",
            "file": "modules/auxiliary/scanner/http/citrix_dir_traversal.rb",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/http/citrix_dir_traversal.rb"
          }
        },
        {
          "id": "citrix_dir_traversal_rce.rb",
          "parameters": {
            "title": "Citrix ADC (NetScaler) Directory Traversal RCE",
            "file": "modules/exploits/linux/http/citrix_dir_traversal_rce.rb",
            "url": "https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/citrix_dir_traversal_rce.rb"
          }
        }
      ]
    },
    {
      "saint": [
        {
          "id": "misc_citrixnetscalerver",
          "parameters": {
            "title": "Citrix ADC and Gateway directory traversal and XML file upload",
            "file": "citrix_adc_dirtrav_xml_upload",
            "url": "https://download.saintcorporation.com/cgi-bin/exploit_info/citrix_adc_dirtrav_xml_upload"
          }
        }
      ]
    }
  ],
  "defense": {
    "preventive": [
      {
        "certvn": [
          {
            "id": "VU#619785",
            "parameters": {
              "class": "bulletin",
              "url": "https://www.kb.cert.org/vuls/id/619785"
            }
          }
        ]
      }
    ],
    "detective": [
      {
        "juniper": [
          {
            "id": "HTTP:DIR:CITRIX-ADC-GW-RCE",
            "parameters": {
              "class": "HTTP",
              "title": "This signature detects attempts to exploit a known vulnerability against Citrix ADC & Gateway. A successful attack can lead to arbitrary code execution.",
              "url": "https://threatlabs.juniper.net/home/search/#/details/?sigtype=ips&sigid=HTTP:DIR:CITRIX-ADC-GW-RCE"
            }
          }
        ]
      },
      {
        "snort": [
          {
            "id": "52662",
            "parameters": {
              "class": "web-application-attack",
              "title": "MALWARE-OTHER Citrix ADC and Gateway backdoor upload attempt",
              "url": "https://snort.org/rule_docs/1-52662/"
            }
          },
          {
            "id": "52620",
            "parameters": {
              "class": "web-application-attack",
              "title": "SERVER-WEBAPP Citrix ADC and Gateway arbitrary code execution attempt",
              "url": "https://snort.org/rule_docs/1-52620/"
            }
          },
          {
            "id": "52603",
            "parameters": {
              "class": "web-application-attack",
              "title": "SERVER-WEBAPP Citrix ADC and Gateway arbitrary code execution attempt",
              "url": "https://snort.org/rule_docs/1-52603/"
            }
          },
          {
            "id": "52513",
            "parameters": {
              "class": "web-application-attack",
              "title": "SERVER-WEBAPP Citrix ADC and Gateway arbitrary code execution attempt",
              "url": "https://snort.org/rule_docs/1-52513/"
            }
          },
          {
            "id": "52512",
            "parameters": {
              "class": "web-application-attack",
              "title": "SERVER-WEBAPP Citrix ADC and Gateway arbitrary code execution attempt",
              "url": "https://snort.org/rule_docs/1-52512/"
            }
          }
        ]
      },
      {
        "suricata": [
          {
            "id": "2029206",
            "parameters": {
              "class": "attempted-admin",
              "title": "ET EXPLOIT Possible Citrix Application Delivery Controller Arbitrary Code Execution Attempt (CVE-2019-19781)",
              "url": "http://doc.emergingthreats.net/2029206/"
            }
          },
          {
            "id": "2029255",
            "parameters": {
              "class": "attempted-admin",
              "title": "ET EXPLOIT Possible Citrix Application Delivery Controller Arbitrary Code Execution Attempt (CVE-2019-19781) M2",
              "url": "http://doc.emergingthreats.net/2029255/"
            }
          }
        ]
      },
      {
        "yara": [
          {
            "id": "EXPL_Shitrix_Exploit_Code_Jan20_1",
            "parameters": {
              "class": "yara",
              "title": "Detects payloads used in Shitrix exploitation CVE-2019-19781",
              "url": "https://raw.githubusercontent.com/Neo23x0/signature-base/master/yara/exploit_shitrix.yar"
            }
          }
        ]
      }
    ]
  }
}