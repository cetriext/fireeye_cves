{
  "information": {
    "description": [
      {
        "id": "CVE-2018-13379",
        "parameters": {
          "published": "2019-06-04T21:29Z",
          "modified": "2020-11-19T13:15Z",
          "summary": "An Improper Limitation of a Pathname to a Restricted Directory (\"Path Traversal\") in Fortinet FortiOS 6.0.0 to 6.0.4, 5.6.3 to 5.6.7 and 5.4.6 to 5.4.12 under SSL VPN web portal allows an unauthenticated attacker to download system files via special crafted HTTP resource requests."
        }
      }
    ],
    "references": [
      {
        "vendor": "MISC",
        "url": "http://packetstormsecurity.com/files/154146/FortiOS-5.6.7-6.0.4-Credential-Disclosure.html"
      },
      {
        "vendor": "MISC",
        "url": "http://packetstormsecurity.com/files/154147/FortiOS-5.6.7-6.0.4-Credential-Disclosure.html"
      },
      {
        "vendor": "BID",
        "url": "http://www.securityfocus.com/bid/108693"
      },
      {
        "vendor": "MISC",
        "url": "https://devco.re/blog/2019/08/09/attacking-ssl-vpn-part-2-breaking-the-Fortigate-ssl-vpn/"
      },
      {
        "vendor": "CONFIRM",
        "url": "https://fortiguard.com/advisory/FG-IR-18-384"
      },
      {
        "vendor": "MISC",
        "url": "https://github.com/blacklotuslabs/Development/blob/master/Mitigations/CVE/CVE-2018-13379/CVE-2018-13379%20-%20Summary%20%26%20Emergency%20Mitigations.pdf"
      },
      {
        "vendor": "MISC",
        "url": "https://i.blackhat.com/USA-19/Wednesday/us-19-Tsai-Infiltrating-Corporate-Intranet-Like-NSA.pdf"
      }
    ]
  },
  "classification": {
    "targets": [
      {
        "id": 1,
        "parameters": [
          {
            "title": null,
            "cpe2.2": "cpe:/o:fortinet:fortios",
            "cpe2.3": "cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "5.6.3 (including)",
              "to": "5.6.7 (including)"
            }
          },
          {
            "title": null,
            "cpe2.2": "cpe:/o:fortinet:fortios",
            "cpe2.3": "cpe:2.3:o:fortinet:fortios:*:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "6.0.0 (including)",
              "to": "6.0.4 (including)"
            }
          }
        ]
      }
    ],
    "packages": [
      {
        "fortinet": [
          {
            "product": "fortios",
            "version": {
              "affected": "5.6.3",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "5.6.4",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "5.6.5",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "5.6.6",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "5.6.7",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "6.0.0",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "6.0.1",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "6.0.2",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "6.0.3",
              "condition": "equal"
            }
          },
          {
            "product": "fortios",
            "version": {
              "affected": "6.0.4",
              "condition": "equal"
            }
          }
        ]
      }
    ],
    "weaknesses": [
      {
        "id": "CWE-22",
        "parameters": {
          "class": "weakness",
          "title": "Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
          "relationship": "CWE-668,CWE-706",
          "url": "https://cwe.mitre.org/data/definitions/22.html",
          "attack_patterns": [
            {
              "id": "CAPEC-79",
              "parameters": {
                "title": "Using Slashes in Alternate Encoding",
                "attack_methods": "",
                "mitigations": "Assume all input is malicious. Create an allowlist that defines all valid input to the application based on the requirements specifications. Input that does not match against the allowlist should not be permitted to enter into the system.|In the case of path traversals, use the principle of least privilege when determining access rights to file systems. Do not allow users to access directories/files that they should not access.|Test your path decoding process against malicious input.|Be aware of the threat of alternative method of data encoding and obfuscation technique such as IP address encoding. (See related guideline section)|There are tools to scan HTTP requests to the server for valid URL such as URLScan from Microsoft (http://www.microsoft.com/technet/security/tools/urlscan.mspx)|When client input is required from web-based forms, avoid using the \"GET\" method to submit data, as the method causes the form data to be appended to the URL and is easily manipulated. Instead, use the \"POST method whenever possible.|Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process. Refer to the RFCs to safely decode URL.",
                "url": "https://capec.mitre.org/data/definitions/79.html"
              }
            },
            {
              "id": "CAPEC-78",
              "parameters": {
                "title": "Using Escaped Slashes in Alternate Encoding",
                "attack_methods": "",
                "mitigations": "Avoid making decisions based on names of resources (e.g. files) if those resources can have alternate names.|Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process.|In the case of path traversals, use the principle of least privilege when determining access rights to file systems. Do not allow users to access directories/files that they should not access.|Regular expressions can be used to filter out backslash. Make sure you decode before filtering and validating the untrusted input data.|Be aware of the threat of alternative method of data encoding.|Assume all input is malicious. Create an allowlist that defines all valid input to the software system based on the requirements specifications. Input that does not match against the allowlist should not be permitted to enter into the system.|Verify that the user-supplied data does not use backslash character to escape malicious characters.",
                "url": "https://capec.mitre.org/data/definitions/78.html"
              }
            },
            {
              "id": "CAPEC-76",
              "parameters": {
                "title": "Manipulating Web Input to File System Calls",
                "attack_methods": "",
                "mitigations": "Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.|Design: For interactive user applications, consider if direct file system interface is necessary, instead consider having the application proxy communication.|Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.|Design: Ensure all input is validated, and does not contain file system commands|Design: Enforce principle of least privilege.",
                "url": "https://capec.mitre.org/data/definitions/76.html"
              }
            },
            {
              "id": "CAPEC-64",
              "parameters": {
                "title": "Using Slashes and URL Encoding Combined to Bypass Validation Logic",
                "attack_methods": "",
                "mitigations": "There are tools to scan HTTP requests to the server for valid URL such as URLScan from Microsoft (http://www.microsoft.com/technet/security/tools/urlscan.mspx).|Regular expression can be used to match safe URL patterns. However, that may discard valid URL requests if the regular expression is too restrictive.|Refer to the RFCs to safely decode URL.|Any security checks should occur after the data has been decoded and validated as correct data format. Do not repeat decoding process, if bad character are left after decoding process, treat the data as suspicious, and fail the validation process.|When client input is required from web-based forms, avoid using the \"GET\" method to submit data, as the method causes the form data to be appended to the URL and is easily manipulated. Instead, use the \"POST method whenever possible.|Be aware of the threat of alternative method of data encoding and obfuscation technique such as IP address encoding.|Assume all input is malicious. Create an allowlist that defines all valid input to the software system based on the requirements specifications. Input that does not match against the allowlist should not be permitted to enter into the system. Test your decoding process against malicious input.",
                "url": "https://capec.mitre.org/data/definitions/64.html"
              }
            },
            {
              "id": "CAPEC-126",
              "parameters": {
                "title": "Path Traversal",
                "attack_methods": "",
                "mitigations": "Implementation: Validate user input by only accepting known good. Ensure all content that is delivered to client is sanitized against an acceptable content specification -- using an allowlist approach.|Implementation: Use possible permissions on file access when developing and deploying web applications.|Implementation: Use indirect references rather than actual file names.|Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.|Implementation: Perform input validation for all remote content, including remote and user-generated content.|Implementation: Host integrity monitoring for critical files, directories, and processes. The goal of host integrity monitoring is to be aware when a security issue has occurred so that incident response and other forensic activities can begin.|Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.|Design: Proxy communication to host, so that communications are terminated at the proxy, sanitizing the requests before forwarding to server host.|Design: Input validation. Assume that user inputs are malicious. Utilize strict type, character, and encoding enforcement.|Design: Execute programs with constrained privileges, so parent process does not open up further vulnerabilities. Ensure that all directories, temporary directories and files, and memory are executing with limited privileges to protect against remote execution.|Design: Enforce principle of least privilege.|Design: Configure the access control correctly.",
                "url": "https://capec.mitre.org/data/definitions/126.html"
              }
            }
          ],
          "ranking": {
            "categorization": [
              {
                "id": "CWE-1031",
                "parameters": {
                  "title": "OWASP Top Ten 2017 Category A5 - Broken Access Control",
                  "url": "https://cwe.mitre.org/data/definitions/1031.html"
                }
              },
              {
                "id": "CWE-1131",
                "parameters": {
                  "title": "CISQ Quality Measures - Security",
                  "url": "https://cwe.mitre.org/data/definitions/1131.html"
                }
              },
              {
                "id": "CWE-1200",
                "parameters": {
                  "title": "Weaknesses in the 2019 CWE Top 25 Most Dangerous Software Errors",
                  "url": "https://cwe.mitre.org/data/definitions/1200.html"
                }
              },
              {
                "id": "CWE-1308",
                "parameters": {
                  "title": "CISQ Quality Measures - Security",
                  "url": "https://cwe.mitre.org/data/definitions/1308.html"
                }
              },
              {
                "id": "CWE-1350",
                "parameters": {
                  "title": "Weaknesses in the 2020 CWE Top 25 Most Dangerous Software Weaknesses",
                  "url": "https://cwe.mitre.org/data/definitions/1350.html"
                }
              },
              {
                "id": "CWE-635",
                "parameters": {
                  "title": "Weaknesses Originally Used by NVD from 2008 to 2016",
                  "url": "https://cwe.mitre.org/data/definitions/635.html"
                }
              },
              {
                "id": "CWE-715",
                "parameters": {
                  "title": "OWASP Top Ten 2007 Category A4 - Insecure Direct Object Reference",
                  "url": "https://cwe.mitre.org/data/definitions/715.html"
                }
              },
              {
                "id": "CWE-723",
                "parameters": {
                  "title": "OWASP Top Ten 2004 Category A2 - Broken Access Control",
                  "url": "https://cwe.mitre.org/data/definitions/723.html"
                }
              },
              {
                "id": "CWE-743",
                "parameters": {
                  "title": "CERT C Secure Coding Standard (2008) Chapter 10 - Input Output (FIO)",
                  "url": "https://cwe.mitre.org/data/definitions/743.html"
                }
              },
              {
                "id": "CWE-802",
                "parameters": {
                  "title": "2010 Top 25 - Risky Resource Management",
                  "url": "https://cwe.mitre.org/data/definitions/802.html"
                }
              },
              {
                "id": "CWE-813",
                "parameters": {
                  "title": "OWASP Top Ten 2010 Category A4 - Insecure Direct Object References",
                  "url": "https://cwe.mitre.org/data/definitions/813.html"
                }
              },
              {
                "id": "CWE-865",
                "parameters": {
                  "title": "2011 Top 25 - Risky Resource Management",
                  "url": "https://cwe.mitre.org/data/definitions/865.html"
                }
              },
              {
                "id": "CWE-877",
                "parameters": {
                  "title": "CERT C++ Secure Coding Section 09 - Input Output (FIO)",
                  "url": "https://cwe.mitre.org/data/definitions/877.html"
                }
              },
              {
                "id": "CWE-884",
                "parameters": {
                  "title": "CWE Cross-section",
                  "url": "https://cwe.mitre.org/data/definitions/884.html"
                }
              },
              {
                "id": "CWE-932",
                "parameters": {
                  "title": "OWASP Top Ten 2013 Category A4 - Insecure Direct Object References",
                  "url": "https://cwe.mitre.org/data/definitions/932.html"
                }
              },
              {
                "id": "CWE-981",
                "parameters": {
                  "title": "SFP Secondary Cluster: Path Traversal",
                  "url": "https://cwe.mitre.org/data/definitions/981.html"
                }
              }
            ],
            "wasc": [
              {
                "id": "WASC-33",
                "parameters": {
                  "title": "Path Traversal",
                  "url": "http://projects.webappsec.org/Path-Traversal"
                }
              }
            ],
            "att&ck_mitre": []
          }
        }
      }
    ]
  },
  "risk": {
    "cvss": {
      "cvss2": {
        "vector": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
        "base_score": "5.0",
        "impact_score": "2.9",
        "exploit_score": "10.0",
        "access_vector": "NETWORK",
        "access_complexity": "LOW",
        "authentication": "NONE",
        "confidentiality_impact": "PARTIAL",
        "integrity_impact": "NONE",
        "availability_impact": "NONE"
      },
      "cvss3": {
        "vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
        "base_score": "9.8",
        "impact_score": "5.9",
        "exploit_score": "3.9",
        "attack_vector": "NETWORK",
        "attack_complexity": "LOW",
        "privileges_required": "NONE",
        "user_interaction": "NONE",
        "score": "UNCHANGED",
        "confidentiality_impact": "HIGH",
        "integrity_impact": "HIGH",
        "availability_impact": "HIGH"
      }
    }
  },
  "inspection": {
    "remote": [
      {
        "nessus": [
          {
            "id": "128552",
            "parameters": {
              "family": "Firewalls",
              "name": "Fortinet FortiOS SSL VPN Directory Traversal Vulnerability (FG-IR-18-384) (Direct Check)",
              "file": "fortios_FG-IR-18-384_direct.nasl",
              "url": "https://www.tenable.com/plugins/index.php?view=single&id=128552"
            }
          },
          {
            "id": "125885",
            "parameters": {
              "family": "Firewalls",
              "name": "Fortinet FortiOS 5.4.6 <= 5.4.12 / 5.6.3 < 5.6.8 / 6.0.x < 6.0.5 SSL VPN Directory Traversal (FG-IR-18-384)",
              "file": "fortios_FG-IR-18-384.nasl",
              "url": "https://www.tenable.com/plugins/index.php?view=single&id=125885"
            }
          }
        ]
      }
    ],
    "local": []
  },
  "exploitation": [
    {
      "d2sec": [
        {
          "id": "fortinet_fortigate_ssl_vpn_file_disclosure",
          "parameters": {
            "title": "Fortinet FortiGate SSL VPN File Disclosure",
            "file": "fortinet_fortigate_ssl_vpn_file_disclosure",
            "url": "https://www.d2sec.com/exploits/fortinet_fortigate_ssl_vpn_file_disclosure.html"
          }
        }
      ]
    },
    {
      "exploitdb": [
        {
          "id": "47287",
          "parameters": {
            "title": "FortiOS 5.6.3 - 5.6.7 / FortiOS 6.0.0 - 6.0.4 - Credentials Disclosure (Metasploit)",
            "file": "exploit-database/exploits/hardware/webapps/47287.rb",
            "url": "https://www.exploit-db.com/exploits/47287/"
          }
        },
        {
          "id": "47288",
          "parameters": {
            "title": "FortiOS 5.6.3 - 5.6.7 / FortiOS 6.0.0 - 6.0.4 - Credentials Disclosure",
            "file": "exploit-database/exploits/hardware/webapps/47288.py",
            "url": "https://www.exploit-db.com/exploits/47288/"
          }
        }
      ]
    },
    {
      "github": [
        {
          "id": "201745739",
          "parameters": {
            "title": "CVE-2018-13379",
            "file": "https://github.com/milo2012/CVE-2018-13379",
            "url": "https://github.com/milo2012/CVE-2018-13379"
          }
        },
        {
          "id": "203047235",
          "parameters": {
            "title": "Fortigate CVE-2018-13379 - Tool to search for vulnerable Fortigate hosts in Rapid7 Project Sonar data anonymously through The Tor network.",
            "file": "https://github.com/jpiechowka/at-doom-fortigate",
            "url": "https://github.com/jpiechowka/at-doom-fortigate"
          }
        },
        {
          "id": "210555795",
          "parameters": {
            "title": "CVE-2018-13379 Exploit",
            "file": "https://github.com/0xHunter/FortiOS-Credentials-Disclosure",
            "url": "https://github.com/0xHunter/FortiOS-Credentials-Disclosure"
          }
        },
        {
          "id": "214945628",
          "parameters": {
            "title": "CVE-2018-13379 Script for Nmap NSE.",
            "file": "https://github.com/Blazz3/cve2018-13379-nmap-script",
            "url": "https://github.com/Blazz3/cve2018-13379-nmap-script"
          }
        },
        {
          "id": "264794936",
          "parameters": {
            "title": "yukar1z0e/CVE-2018-13379",
            "file": "https://github.com/yukar1z0e/CVE-2018-13379",
            "url": "https://github.com/yukar1z0e/CVE-2018-13379"
          }
        },
        {
          "id": "296403562",
          "parameters": {
            "title": "mandr4x/CVE-2018-13379-FortinetVPN",
            "file": "https://github.com/mandr4x/CVE-2018-13379-FortinetVPN",
            "url": "https://github.com/mandr4x/CVE-2018-13379-FortinetVPN"
          }
        },
        {
          "id": "296403562",
          "parameters": {
            "title": "pwn3z/CVE-2018-13379-FortinetVPN",
            "file": "https://github.com/pwn3z/CVE-2018-13379-FortinetVPN",
            "url": "https://github.com/pwn3z/CVE-2018-13379-FortinetVPN"
          }
        },
        {
          "id": "314373083",
          "parameters": {
            "title": "FortiVuln",
            "file": "https://github.com/k4nfr3/CVE-2018-13379-Fortinet",
            "url": "https://github.com/k4nfr3/CVE-2018-13379-Fortinet"
          }
        },
        {
          "id": "CVE-2018-13379%20-%20Summary%20%26%20Emergency%20Mitigations.pdf",
          "parameters": {
            "title": "",
            "file": "CVE-2018-13379%20-%20Summary%20%26%20Emergency%20Mitigations.pdf",
            "url": "https://github.com/blacklotuslabs/Development/blob/master/Mitigations/CVE/CVE-2018-13379/CVE-2018-13379%20-%20Summary%20%26%20Emergency%20Mitigations.pdf"
          }
        }
      ]
    },
    {
      "packetstorm": [
        {
          "id": "154146",
          "parameters": {
            "title": "FortiOS 5.6.7 6.0.4 Credential Disclosure",
            "file": "http://packetstormsecurity.com/files/154146/FortiOS-5.6.7-6.0.4-Credential-Disclosure.html",
            "url": "http://packetstormsecurity.com/files/154146/FortiOS-5.6.7-6.0.4-Credential-Disclosure.html"
          }
        },
        {
          "id": "154147",
          "parameters": {
            "title": "FortiOS 5.6.7 6.0.4 Credential Disclosure",
            "file": "http://packetstormsecurity.com/files/154147/FortiOS-5.6.7-6.0.4-Credential-Disclosure.html",
            "url": "http://packetstormsecurity.com/files/154147/FortiOS-5.6.7-6.0.4-Credential-Disclosure.html"
          }
        }
      ]
    }
  ],
  "defense": {
    "preventive": [
      {
        "bid": [
          {
            "id": "108693",
            "parameters": {
              "class": "bulletin",
              "url": "http://www.securityfocus.com/bid/108693"
            }
          }
        ]
      }
    ],
    "detective": [
      {
        "snort": [
          {
            "id": "51372",
            "parameters": {
              "class": "web-application-attack",
              "title": "SERVER-WEBAPP Fortinet FortiOS SSL VPN web portal directory traversal attempt",
              "url": "https://snort.org/rule_docs/1-51372/"
            }
          },
          {
            "id": "51371",
            "parameters": {
              "class": "web-application-attack",
              "title": "SERVER-WEBAPP Fortinet FortiOS SSL VPN web portal directory traversal attempt",
              "url": "https://snort.org/rule_docs/1-51371/"
            }
          },
          {
            "id": "51370",
            "parameters": {
              "class": "web-application-attack",
              "title": "SERVER-WEBAPP Fortinet FortiOS SSL VPN web portal directory traversal attempt",
              "url": "https://snort.org/rule_docs/1-51370/"
            }
          }
        ]
      },
      {
        "suricata": [
          {
            "id": "2027883",
            "parameters": {
              "class": "attempted-admin",
              "title": "ET EXPLOIT FortiOS SSL VPN - Information Disclosure (CVE-2018-13379)",
              "url": "http://doc.emergingthreats.net/2027883/"
            }
          }
        ]
      }
    ]
  }
}