{
  "information": {
    "description": [
      {
        "id": "CVE-2016-0167",
        "parameters": {
          "published": "2016-04-12T23:59Z",
          "modified": "2018-10-12T22:11Z",
          "summary": "The kernel-mode driver in Microsoft Windows Vista SP2, Windows Server 2008 SP2 and R2 SP1, Windows 7 SP1, Windows 8.1, Windows Server 2012 Gold and R2, Windows RT 8.1, and Windows 10 Gold and 1511 allows local users to gain privileges via a crafted application, aka \"Win32k Elevation of Privilege Vulnerability,\" a different vulnerability than CVE-2016-0143 and CVE-2016-0165."
        }
      }
    ],
    "references": [
      {
        "vendor": "MISC",
        "url": "http://www.securitytracker.com/id/1035529"
      },
      {
        "vendor": "MISC",
        "url": "http://www.securitytracker.com/id/1035532"
      },
      {
        "vendor": "MISC",
        "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-039"
      }
    ]
  },
  "classification": {
    "targets": [
      {
        "id": 1,
        "parameters": [
          {
            "title": null,
            "cpe2.2": "cpe:/o:microsoft:windows_10:-",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_10:-:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": null,
            "cpe2.2": "cpe:/o:microsoft:windows_10:1511",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_10:1511:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": null,
            "cpe2.2": "cpe:/o:microsoft:windows_7::sp1",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_7:*:sp1:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": null,
            "cpe2.2": "cpe:/o:microsoft:windows_8.1",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_8.1:*:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Microsoft Windows RT 8.1",
            "cpe2.2": "cpe:/o:microsoft:windows_rt_8.1:-",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_rt_8.1:-:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": null,
            "cpe2.2": "cpe:/o:microsoft:windows_server_2008::sp2",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_server_2008:*:sp2:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Microsoft Windows Server 2008 R2 Service Pack 1",
            "cpe2.2": "cpe:/o:microsoft:windows_server_2008:r2:sp1",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_server_2008:r2:sp1:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": "Microsoft Windows Server 2012",
            "cpe2.2": "cpe:/o:microsoft:windows_server_2012:-",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_server_2012:-:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": null,
            "cpe2.2": "cpe:/o:microsoft:windows_server_2012:r2",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_server_2012:r2:*:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          },
          {
            "title": null,
            "cpe2.2": "cpe:/o:microsoft:windows_vista::sp2",
            "cpe2.3": "cpe:2.3:o:microsoft:windows_vista:*:sp2:*:*:*:*:*:*",
            "version_affected": {
              "from": "",
              "to": ""
            }
          }
        ]
      }
    ],
    "packages": [
      {
        "microsoft": [
          {
            "product": "windows 10",
            "version": {
              "affected": "-",
              "condition": "equal"
            }
          },
          {
            "product": "windows 10",
            "version": {
              "affected": "1511",
              "condition": "equal"
            }
          },
          {
            "product": "windows 7",
            "version": {
              "affected": "*",
              "condition": "equal"
            }
          },
          {
            "product": "windows 8.1",
            "version": {
              "affected": "*",
              "condition": "equal"
            }
          },
          {
            "product": "windows rt 8.1",
            "version": {
              "affected": "-",
              "condition": "equal"
            }
          },
          {
            "product": "windows server 2008",
            "version": {
              "affected": "*",
              "condition": "equal"
            }
          },
          {
            "product": "windows server 2008",
            "version": {
              "affected": "r2",
              "condition": "equal"
            }
          },
          {
            "product": "windows server 2012",
            "version": {
              "affected": "-",
              "condition": "equal"
            }
          },
          {
            "product": "windows server 2012",
            "version": {
              "affected": "r2",
              "condition": "equal"
            }
          },
          {
            "product": "windows vista",
            "version": {
              "affected": "*",
              "condition": "equal"
            }
          }
        ]
      }
    ],
    "weaknesses": [
      {
        "id": "CWE-264",
        "parameters": {
          "class": "category",
          "title": "Permissions, Privileges, and Access Controls",
          "relationship": "",
          "url": "https://cwe.mitre.org/data/definitions/264.html",
          "attack_patterns": [
            {
              "id": "CAPEC-76",
              "parameters": {
                "title": "Manipulating Web Input to File System Calls",
                "attack_methods": "",
                "mitigations": "Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.|Design: For interactive user applications, consider if direct file system interface is necessary, instead consider having the application proxy communication.|Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.|Design: Ensure all input is validated, and does not contain file system commands|Design: Enforce principle of least privilege.",
                "url": "https://capec.mitre.org/data/definitions/76.html"
              }
            },
            {
              "id": "CAPEC-69",
              "parameters": {
                "title": "Target Programs with Elevated Privileges",
                "attack_methods": "",
                "mitigations": "Protect your log file from unauthorized modification and log forging.|Monitor traffic and resource usage and pay attention if resource exhaustion occurs.|Check your program for buffer overflow and format String vulnerabilities which can lead to execution of malicious code.|If possible use a sandbox model which limits the actions that programs can take. A sandbox restricts a program to a set of privileges and commands that make it difficult or impossible for the program to cause any damage.|Make sure that your program or service fail safely. What happen if the communication protocol is interrupted suddenly? What happen if a parameter is missing? Does your system have resistance and resilience to attack? Fail safely when a resource exhaustion occurs.|Avoid revealing information about your system (e.g., version of the program) to anonymous users.|Scan your services and disable the ones which are not needed and are exposed unnecessarily. Exposing programs increases the attack surface. Only expose the services which are needed and have security mechanisms such as authentication built around them.|Apply the latest patches.|Validate all untrusted data.|Apply the principle of least privilege.",
                "url": "https://capec.mitre.org/data/definitions/69.html"
              }
            },
            {
              "id": "CAPEC-58",
              "parameters": {
                "title": "Restful Privilege Elevation",
                "attack_methods": "",
                "mitigations": "Implementation: Ensure that HTTP methods have proper ACLs based on what the functionality they expose|Implementation: Ensure that HTTP Get methods only retrieve state and do not alter state on the server side|Design: Enforce principle of least privilege",
                "url": "https://capec.mitre.org/data/definitions/58.html"
              }
            },
            {
              "id": "CAPEC-35",
              "parameters": {
                "title": "Leverage Executable Code in Non-Executable Files",
                "attack_methods": "",
                "mitigations": "Implementation: Ensure that files that are not required to execute, such as configuration files, are not over-privileged, i.e. not allowed to execute.|Implementation: Implement host integrity monitoring to detect any unwanted altering of configuration files.|Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.|Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.|Design: Enforce principle of least privilege",
                "url": "https://capec.mitre.org/data/definitions/35.html"
              }
            },
            {
              "id": "CAPEC-17",
              "parameters": {
                "title": "Using Malicious Files",
                "attack_methods": "",
                "mitigations": "Implementation: Perform testing such as pen-testing and vulnerability scanning to identify directories, programs, and interfaces that grant direct access to executables.|Design: Run server interfaces with a non-root account and/or utilize chroot jails or other configuration techniques to constrain privileges even if attacker gains some limited access to commands.|Design: Enforce principle of least privilege",
                "url": "https://capec.mitre.org/data/definitions/17.html"
              }
            }
          ],
          "ranking": {
            "categorization": [],
            "wasc": [],
            "att&ck_mitre": [
              {
                "id": "T1574.010",
                "parameters": {
                  "profile": "mitre-attack",
                  "name": "Services File Permissions Weakness",
                  "description": "Adversaries may execute their own malicious payloads by hijacking the binaries used by services. Adversaries may use flaws in the permissions of Windows services to replace the binary that is executed upon service start. These service processes may automatically execute specific binaries as part of their functionality or to perform other actions. If the permissions on the file system directory containing a target binary, or permissions on the binary itself are improperly set, then the target binary may be overwritten with another binary using user-level permissions and executed by the original process. If the original process and thread are running under a higher permissions level, then the replaced binary will also execute under higher-level permissions, which could include SYSTEM.\n\nAdversaries may use this technique to replace legitimate binaries with malicious ones as a means of executing code at a higher permissions level. If the executing process is set to run at a specific time or during a certain event (e.g., system bootup) then this technique can also be used for persistence.",
                  "tactic": "defense-evasion,privilege-escalation,persistence",
                  "permission_required": "User,Administrator",
                  "bypassed_defenses": "",
                  "data_sources": "File monitoring,Services,Process command-line parameters",
                  "url": "https://attack.mitre.org/techniques/T1574/010",
                  "file": "https://raw.githubusercontent.com/mitre/cti/master/enterprise-attack/attack-pattern/attack-pattern--9e8b28c9-35fe-48ac-a14d-e6cc032dcbcd.json"
                }
              }
            ]
          }
        }
      }
    ]
  },
  "risk": {
    "cvss": {
      "cvss2": {
        "vector": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
        "base_score": "7.2",
        "impact_score": "10.0",
        "exploit_score": "3.9",
        "access_vector": "LOCAL",
        "access_complexity": "LOW",
        "authentication": "NONE",
        "confidentiality_impact": "COMPLETE",
        "integrity_impact": "COMPLETE",
        "availability_impact": "COMPLETE"
      },
      "cvss3": {
        "vector": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
        "base_score": "7.8",
        "impact_score": "5.9",
        "exploit_score": "1.8",
        "attack_vector": "LOCAL",
        "attack_complexity": "LOW",
        "privileges_required": "LOW",
        "user_interaction": "NONE",
        "score": "UNCHANGED",
        "confidentiality_impact": "HIGH",
        "integrity_impact": "HIGH",
        "availability_impact": "HIGH"
      }
    }
  },
  "inspection": {
    "remote": [
      {
        "nessus": [
          {
            "id": "90433",
            "parameters": {
              "family": "Windows : Microsoft Bulletins",
              "name": "MS16-039: Security Update for Microsoft Graphics Component (3148522)",
              "file": "smb_nt_ms16-039.nasl",
              "url": "https://www.tenable.com/plugins/index.php?view=single&id=90433"
            }
          }
        ]
      },
      {
        "openvas": [
          {
            "id": "806699",
            "parameters": {
              "family": "Windows : Microsoft Bulletins",
              "name": "Microsoft Graphics Component Multiple Vulnerabilities (3148522)",
              "file": "gb_ms16-039.nasl",
              "url": "https://secinfo.greenbone.net/omp?cmd=get_info&info_type=nvt&token=guest&filter=806699"
            }
          }
        ]
      }
    ],
    "local": [
      {
        "oval-cis": [
          {
            "id": "oval:org.cisecurity:def:480",
            "parameters": {
              "family": "vulnerability",
              "name": "Win32k Elevation of Privilege Vulnerability \u2013 CVE-2016-0167 (MS16-039)",
              "file": "oval_org.cisecurity_def_480.xml",
              "url": "https://oval.cisecurity.org/repository/search/definition/oval:org.cisecurity:def:480"
            }
          }
        ]
      }
    ]
  },
  "exploitation": [
    {
      "google": [
        {
          "id": "CVE-2016-0167",
          "parameters": {
            "title": "Use-after-free in win32k!xxxMNDestroyHandler (Memory Corruption)",
            "file": "https://www.fireeye.com/blog/threat-research/2016/05/windows-zero-day-payment-cards.html",
            "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2016/ms16-039"
          }
        }
      ]
    }
  ],
  "defense": {
    "preventive": [
      {
        "microsoft": [
          {
            "id": "3148522",
            "parameters": {
              "class": "fix",
              "url": "https://support.microsoft.com/help/3148522"
            }
          },
          {
            "id": "MS16-039",
            "parameters": {
              "class": "fix",
              "url": "https://technet.microsoft.com/en-us/library/security/ms16-039"
            }
          },
          {
            "id": "3145739",
            "parameters": {
              "class": "fix",
              "url": "https://support.microsoft.com/help/3145739"
            }
          },
          {
            "id": "3147458",
            "parameters": {
              "class": "fix",
              "url": "https://support.microsoft.com/help/3147458"
            }
          },
          {
            "id": "3147461",
            "parameters": {
              "class": "fix",
              "url": "https://support.microsoft.com/help/3147461"
            }
          },
          {
            "id": "CVE-2016-0167",
            "parameters": {
              "class": "bulletin",
              "url": "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2016-0167"
            }
          }
        ]
      }
    ],
    "detective": [
      {
        "juniper": [
          {
            "id": "HTTP:STC:DL:MS-CREATEPOPUP-MC",
            "parameters": {
              "class": "HTTP",
              "title": "This signature detects attempts to exploit a known vulnerability against Microsoft Windows DrawMenuBarTemp. A successful attack can lead to memory corruption and arbitrary code execution.",
              "url": "https://threatlabs.juniper.net/home/search/#/details/?sigtype=ips&sigid=HTTP:STC:DL:MS-CREATEPOPUP-MC"
            }
          }
        ]
      },
      {
        "snort": [
          {
            "id": "39079",
            "parameters": {
              "class": "attempted-dos",
              "title": "OS-WINDOWS Kaspersky Internet Security KLIF driver denial of service attempt",
              "url": "https://snort.org/rule_docs/1-39079/"
            }
          },
          {
            "id": "39078",
            "parameters": {
              "class": "attempted-dos",
              "title": "OS-WINDOWS Kaspersky Internet Security KLIF driver denial of service attempt",
              "url": "https://snort.org/rule_docs/1-39078/"
            }
          },
          {
            "id": "38766",
            "parameters": {
              "class": "attempted-admin",
              "title": "OS-WINDOWS Microsoft Windows Dxgkrnl.sys RtlMemoryCopy buffer overflow attempt",
              "url": "https://snort.org/rule_docs/1-38766/"
            }
          },
          {
            "id": "38765",
            "parameters": {
              "class": "attempted-admin",
              "title": "OS-WINDOWS Microsoft Windows Dxgkrnl.sys RtlMemoryCopy buffer overflow attempt",
              "url": "https://snort.org/rule_docs/1-38765/"
            }
          },
          {
            "id": "38492",
            "parameters": {
              "class": "attempted-user",
              "title": "OS-WINDOWS Microsoft Windows CreatePopupMenu win32k.sys use after free attempt",
              "url": "https://snort.org/rule_docs/1-38492/"
            }
          },
          {
            "id": "38491",
            "parameters": {
              "class": "attempted-user",
              "title": "OS-WINDOWS Microsoft Windows CreatePopupMenu win32k.sys use after free attempt",
              "url": "https://snort.org/rule_docs/1-38491/"
            }
          }
        ]
      }
    ]
  }
}